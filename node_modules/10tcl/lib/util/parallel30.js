module.exports = function(actions, finalCB){

	var p30 = {}

	p30.actions = actions
	p30.finalCB = finalCB

	p30.isItOver = function(){
		var allDone = true
		p30.actions.each( function(name, action){
			if (!action.done) allDone = false
		})
		if (allDone) p30.finalCB( p30.actions )
	}

	p30.end = function( aName ){
		return function(){
			p30.actions[aName].results = p30.actions[aName].cb.apply( null, arguments)
			p30.actions[aName].done = true
			p30.isItOver()
		}
	}

	p30.actions.each( function(name, action){
		action.fn.call( p30 )
	})

}